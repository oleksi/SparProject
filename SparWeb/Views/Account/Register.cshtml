@model SparWeb.Models.RegisterViewModel
@using SparWeb.Models

@{
    ViewBag.Title = "Register";
}

@using (Html.BeginForm("Register", "Account", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    <div class="row">
        <div class="col-md-6">
            <div class="col-md-offset-4 col-md-8">
                <h2>@ViewBag.Title.</h2>
                @Html.AntiForgeryToken()
                <h4>Create a new account.</h4>
                <p>Have an account already? @Html.ActionLink("Click Here to login", "Login", "Account")</p>
                <hr />
            </div>
            <div class="form-group">
                <div class="col-md-offset-4 col-md-8">
                    @Html.ValidationSummary(true)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.UserName, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    @Html.TextBoxFor(m => m.UserName, new { @class = "form-control", placeholder = Html.DisplayNameFor(m => m.UserName) })
                    @Html.ValidationMessageFor(m => m.UserName)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.Password, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    @Html.PasswordFor(m => m.Password, new { @class = "form-control", placeholder = Html.DisplayNameFor(m => m.Password) })
                    @Html.ValidationMessageFor(m => m.Password)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.ConfirmPassword, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    @Html.PasswordFor(m => m.ConfirmPassword, new { @class = "form-control", placeholder = Html.DisplayNameFor(m => m.ConfirmPassword) })
                    @Html.ValidationMessageFor(m => m.ConfirmPassword)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.Name, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    @Html.TextBoxFor(m => m.Name, new { @class = "form-control", placeholder = Html.DisplayNameFor(m => m.Name) })
                    @Html.ValidationMessageFor(m => m.Name)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.Sex, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    @Html.EditorFor(m => m.Sex, "Sex")
                    @Html.ValidationMessageFor(m => m.Sex)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.DateOfBirth, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12">
                            @Html.EditorFor(m => m.DateOfBirth, "DateOfBirth")
                            @Html.ValidationMessageFor(m => m.DateOfBirth)
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">@Html.ValidationMessageFor(m => m.DateOfBirth.Month)</div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">@Html.ValidationMessageFor(m => m.DateOfBirth.Day)</div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">@Html.ValidationMessageFor(m => m.DateOfBirth.Year)</div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.City, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    @Html.TextBoxFor(m => m.City, new { @class = "form-control", placeholder = Html.DisplayNameFor(m => m.City) })
                    @Html.ValidationMessageFor(m => m.City)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.State, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12">
                            @Html.DropDownListFor(m => m.State, (new SelectList(ViewBag.States, "Key", "Value", Model.State)), "Please select", new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            @Html.ValidationMessageFor(m => m.State)
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.GymId, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12">
                            @Html.DropDownListFor(m => m.GymId, (new SelectList(ViewBag.AllGyms, "Key", "Value", Model.GymId)), "Please select your gym (optional)", new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            Can't find your gym? <a href="#newGymModal" data-toggle="modal">Click here</a> to add!
                            @Html.HiddenFor(m => m.NewGymName)
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.Height, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12">
                            @Html.DropDownListFor(m => m.Height, (new SelectList(ViewBag.HeightToCentimetersMap, "Key", "Value", Model.Height)), "Please select", new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            @Html.ValidationMessageFor(m => m.Height)
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.Weight, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    @Html.DropDownListFor(m => m.Weight, (new SelectList(ViewBag.WeightClassMap, "Key", "Value", Model.Height)), "Please select", new { @class = "form-control" })
                    @Html.ValidationMessageFor(m => m.Weight)
                </div>
            </div>
            <div class="form-group">
                @Html.LabelFor(m => m.NumberOfFights, new { @class = "col-md-4 control-label" })
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-6">
                            @Html.TextBoxFor(m => m.NumberOfFights, new { @class = "form-control", placeholder = Html.DisplayNameFor(m => m.NumberOfFights) })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            @Html.ValidationMessageFor(m => m.NumberOfFights)
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-offset-4 col-md-8">
                    <input type="submit" class="btn btn-default btn-primary btn-lg" value="Register" />
                </div>
            </div>
        </div>
        <div class="col-md-6"></div>
    </div>
    

<!-- Modal -->
    <div class="modal fade" id="newGymModal" tabindex="-1" role="dialog" aria-labelledby="newGymModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="newGymModalLabel">Add Your Gym</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <label class="col-md-3 control-label" for="txtNewGymName">Gym Name:</label>
                        <div class="col-md-9">
                            <input type="text" id="txtNewGymName" name="txtNewGymName" class="form-control" placeholder="Enter your gym name" data-val-required="The gym name is required." data-val="true" />
                            <span class="field-validation-valid" data-valmsg-replace="true" data-valmsg-for="txtNewGymName"></span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="addGymButton">Add Gym</button>
                </div>
            </div>
        </div>
    </div>
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    
    <script type="text/javascript">
        $(function () {
            $('#addGymButton').click(function () {
                var validator = $("form").validate();
                if(validator.element("#txtNewGymName"))
                {
                    $('#GymId option[value="-1"]').remove();
                    $('#GymId option:first').after($('<option />', { "value": '-1', text: $('#txtNewGymName').val() }));
                    $('#NewGymName').val($('#txtNewGymName').val());
                    $('#txtNewGymName').val('');
                    $('#GymId').val('-1');
                    $('#newGymModal').modal('hide');
                }
            });
        });
    </script>
}
